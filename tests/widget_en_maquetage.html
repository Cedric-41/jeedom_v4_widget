<div class="cmd #history# container-fluid tooltips cmd-widget netatmodisplay" data-type="info" data-version="#version#" data-eqLogic_id="#eqLogic_id#" data-subtype="other" data-cmd_id="#id#" data-cmd_uid="#uid#">
  <!--<div class="box_full" style="height:100px; background:grey; border-radius:10px;overflow:hidden; border:3px solid cyan">
    <div class="box_haut" style="height:75px;display:flex;color:cyan;">
      <div style="margin:auto;">
        <span class="value">#value#</span> <span class="unite" style="font-size:12px;position:relative;bottom:25px;">#unite#</span>
      </div>
    </div>
    <div class="box_bas" style="height:25px;background-color:cyan;display:flex;">
      <div style="margin:auto; font-size:12px;">#name_display#</div>
    </div>
  </div>-->
  <div class="0" >Text</div>
  <div class="1" >Text</div>
<div class="2" >Text</div>
<div class="3" >Text</div>
<div class="4" >Text</div>
<div class="5">Text</div>
<div class="6" >Text</div>
<div class="7" >Text</div>
<div class="8" >Text</div>
<div class="10" >Text</div>
<div class="11" >Text</div>
<div class="12" >Text</div>
<div class="13" >Text</div>
<div class="14" >Text</div>
<div class="15" >Text</div>
<div class="16" >Text</div>
<div class="17" >Text</div>
<div class="18" >Text</div>
<div class="19" >Text</div>
<div class="20">Text</div>
<div class="21" >Text</div>
<div class="22" >Text</div>
<div class="23" >Text</div>
<div class="24" >Text</div>
<div class="25" >Text</div>
<div class="26" >Text</div>
<div class="27" >Text</div>
<div class="28" >Text</div>
</div>



<script>
  // Returns a single rgb color interpolation between given rgb color
  // based on the factor given; via https://codepen.io/njmcode/pen/axoyD?editors=0010
  function interpolateColor(color1, color2, factor) {
      if (arguments.length < 3) {
          factor = 0.5;
      }
      var result = color1.slice();
      for (var i = 0; i < 3; i++) {
          result[i] = Math.round(result[i] + factor * (color2[i] - color1[i]));
      }
      return result;
  };
  // My function to interpolate between two colors completely, returning an array
  function interpolateColors(color1, color2, steps) {
      var stepFactor = 1 / (steps - 1),
          interpolatedColorArray = [];

      color1 = color1.match(/\d+/g).map(Number);
      color2 = color2.match(/\d+/g).map(Number);

      for(var i = 0; i < steps; i++) {
          interpolatedColorArray.push(interpolateColor(color1, color2, stepFactor * i));
      }

      return interpolatedColorArray;
  }

   function hsl2rgb(color) {
   var l = color[2];

   if (color[1] == 0) {
     l = Math.round(l*255);
     return [l, l, l];
   } else {
     function hue2rgb(p, q, t) {
       if (t < 0) t += 1;
       if (t > 1) t -= 1;
       if (t < 1/6) return p + (q - p) * 6 * t;
       if (t < 1/2) return q;
       if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
       return p;
     }

     var s = color[1];
     var q = (l < 0.5 ? l * (1 + s) : l + s - l * s);
     var p = 2 * l - q;
     var r = hue2rgb(p, q, color[0] + 1/3);
     var g = hue2rgb(p, q, color[0]);
     var b = hue2rgb(p, q, color[0] - 1/3);
     return [Math.round(r*255), Math.round(g*255), Math.round(b*255)];
   }
 };

  function rgb2hsl(color) {
    var r = color[0]/255;
    var g = color[1]/255;
    var b = color[2]/255;

    var max = Math.max(r, g, b), min = Math.min(r, g, b);
    var h, s, l = (max + min) / 2;

    if (max == min) {
      h = s = 0; // achromatic
    } else {
      var d = max - min;
      s = (l > 0.5 ? d / (2 - max - min) : d / (max + min));
      switch(max) {
        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
        case g: h = (b - r) / d + 2; break;
        case b: h = (r - g) / d + 4; break;
      }
      h /= 6;
    }

    return [h, s, l];
  };

   function interpolateHSL(color1, color2, factor) {
    if (arguments.length < 3) { factor = 0.5; }
    var hsl1 = rgb2hsl(color1);
    var hsl2 = rgb2hsl(color2);
    for (var i=0;i<3;i++) {
      hsl1[i] += factor*(hsl2[i]-hsl1[i]);
    }
    return hsl2rgb(hsl1);
  };



  jeedom.cmd.update['#id#'] = function(_options) {
    var cmd = $('.cmd[data-cmd_id=#id#]');

    //var couleur = interpolateColors("rgb(255, 64, 0)", "rgb(0, 255, 255)", 30);
    couleur1='173, 100, 255';
    couleur1=couleur1.split(',');
    couleur2='255, 255, 0';
    couleur2= couleur2.split(',');
    couleur=interpolateHSL(couleur1,couleur2,30);
    var factorstep = 1/ (30-1);
    for(var i = 0; i < 20; i++) {
      color = interpolateHSL(couleur1,couleur2,factorstep * i)



      //cmd.find('.'+i).css('background-color','rgb('+ couleur[i] +');');
      cmd.find('.'+i).css('background-color','rgb('+ color +');');

    }

    // Récupération des valeurs
    var valeur = _options.display_value;
    // Séparation des entier et décimal
    var entier = Math.trunc(valeur);
    $('.cmd[data-cmd_uid=#uid#] .value').text(entier);


    $('.cmd[data-cmd_id=#id#]').attr('title', 'Valeur du ' + _options.valueDate + ', collectée le ' + _options.collectDate);
  }
  jeedom.cmd.update['#id#']({
    display_value: '#state#',
    valueDate: '#valueDate#',
    collectDate: '#collectDate#',
    alertLevel: '#alertLevel#'
  });
</script>
