<!--
//Tarlak :
Version  0.1 :  - Refonte du widget, meilleurs utilisation du css pour ne plus avoir de décallage
                - Suppression des bornages de température pour définir les différents couleurs, elles sont
                maintenant calculée en fonction d'une couleur chaude et d'une couleur froide
                - De nouveau paramètre permettent une meilleur personalisation

Avec l'aide de Domotech pour l'amélioration css, grand merci a lui : http://youtube.com/domotech
** Paramètres option du widget

nom       Nom personnalisé du widget (par défaut le nom de la commande)
-->


<div class="cmd cmd-widget #history#" data-type="info" data-subtype="numeric" data-template="badge" data-cmd_id="#id#" data-cmd_uid="#uid#" data-version="#version#" data-eqLogic_id="#eqLogic_id#">
  <div class="box_full#id#" style="height:100px; width:100px; overflow:hidden;">
    <div class="box_top#id#" style="height:80px;display:flex;width:85px;">
      <div style="margin:auto;">
        <svg class="checkmark" id="follower-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 45 45" enable-background="new 0 0 45 45" xml:space="preserve">
          <g class="person-icon">
            <g class="body-icon">
              <circle class="head" fill-rule="evenodd" clip-rule="evenodd" fill="var(--couleuractualisee#id#)" cx="19.6" cy="17.2" r="7.3"/>
              <path id="body" fill-rule="evenodd" clip-rule="evenodd" fill="var(--couleuractualisee#id#)" d="M9.9,31.7c0-2.7,2.2-4.9,4.9-4.9h10.9c2.7,0,4.9,2.2,4.9,4.9c0,1.3-5.2,4-10.3,4C15,35.7,9.9,33.1,9.9,31.7z"/>
            </g>
          </g>
        </svg>
      </div>
    </div>
    <div class="box_bottom#id#" style="display:flex;">
      <div class="title #hide_name#">
        <div  class="cmdNametar#id# cmdName">nom#id#</div>
      </div>
    </div>
  </div>
  <div class="cmdStats #hide_history#">
    <div class="col-xs-12 center-block">
      <span title='Min' class='tooltips'>#minHistoryValue#</span>|<span title='Moyenne' class='tooltips'>#averageHistoryValue#</span>|<span title='Max' class='tooltips'>#maxHistoryValue#</span> <i class="#tendance#"></i>
    </div>
  </div>

  <style>
    .box_full#id# {
      border-radius: 10px;
      border: 3px solid var(--couleuractualisee#id#);
      background:#FFF;
    }

    [data-theme="core2019_Dark"] .box_full{
      background: transparent !important;
    }

    .box_top#id#{
      position: relative;
      left: 50%;
      -webkit-transform: translateX(-50%);
      -ms-transform: translateX(-50%);
      transform: translateX(-50%);
    }

    .valeurtar#id# {
      font-size: 38px;
    }

    .box_bottom#id# {
      line-height: 20px;
      background: var(--couleuractualisee#id#);
    }

    .cmdNametar#id# {
      text-align: center;
      /*mix-blend-mode: difference;*/
      color: white;
    }

    .unitetar {
      font-size: 12px;
      position: relative;
      bottom: 25px;
      color: cyan;
    }

    .decimaltar{
      font-size:14px;
    }

    :root {
          --absent: #da3037;
          --present: #30b455; /*#829f25;*/
          --noir: #000000;
          --gris: #838383;
          --blanc: #ffffff;
          --couleuractualisee#id#:var(--absent);
    }

  </style>

<script>
  jeedom.cmd.update['#id#'] = function(_options) {
    var cmd = $('.cmd[data-cmd_id=#id#]');

    //Définition des paramètres
    var nom#id# = ('#nom#' != '#' + 'nom#') ? "#nom#" : "#name#"; // remplace le nom de la commande par celui de votre choix
    var couleurch#id# = ('#couleurch#' != '#' + 'couleurch#') ? "#couleurch#" : "#fc0303"; // couleur chaude
    var couleurfr#id# = ('#couleurfr#' != '#' + 'couleurfr#') ? "#couleurfr#" : "#6ecfff"; // couleur froide
    var valmin#id# =  parseInt('#minValue#'); // température minimal
    var valmax#id# =  parseInt('#maxValue#'); // température maximum
    var valeur = _options.display_value;
    cmd.find('.cmdNametar#id#').empty().append(nom#id#);

    // Récupération des valeurs
    if (valeur == 0){
        document.documentElement.style.setProperty('--couleuractualisee#id#', 'var(--absent');
    }
    else if(valeur==1){
        document.documentElement.style.setProperty('--couleuractualisee#id#', 'var(--present');
    }



    $('.cmd[data-cmd_id=#id#]').attr('title', 'Valeur du ' + _options.valueDate + ', collectée le ' + _options.collectDate);
  }
  jeedom.cmd.update['#id#']({
    display_value: '#state#',
    valueDate: '#valueDate#',
    collectDate: '#collectDate#',
    alertLevel: '#alertLevel#'
  });
</script>

</div>
